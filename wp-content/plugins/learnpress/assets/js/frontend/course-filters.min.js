!function(e){"use strict";e.fn.courseFilters=function(t){return e.each(this,(function(){var r=e(this),a=r.attr("id"),u=window.location.href.addQueryVar("course-filter","yes"),o=u,n=r.find(".lp-button-filter"),i=r.find(".lp-button-reset-filter");function l(){return e("#"+a+" .lp-course-attribute-values li.active").length}function c(e){return e=e.replace(/\/page\/[0-9]+/,"").removeQueryVar("paged")}function s(){(u=c(u),o!=u)&&("yes"==r.find(".lp-course-attributes.course-filters").data("ajax")?(LP.setUrl(u),LP.blockContent(),e.ajax({url:u,success:function(t){var r=e(t).contents(),u=r.find(".entry-content"),o=r.find("#"+a);e(".entry-content").replaceWith(u),e("#"+a).replaceWith(o),LP.unblockContent()}})):LP.reload(u),o=u,n.prop("disabled",!0))}function d(){var e=u=c(u);l()||(e=e.removeQueryVar("attribute_operator").removeQueryVar("value_operator").removeQueryVar("course-filter")),0==n.length?s():(u==o?n.prop("disabled",!0):n.prop("disabled",!1),i.prop("disabled",!l())),LP.setUrl(e)}t=e.extend({},{attribute_operator:"and",value_operator:"and",ajax_filter:1,button_filter:1},t||{}),u=u.addQueryVar("attribute_operator",t.attribute_operator).addQueryVar("value_operator",t.value_operator),n.length&&n.off("click").on("click",(function(){s()})),i.off("click").on("click",(function(){e("#"+a+" .lp-course-attribute-values li.active a").each((function(){var t=e(this).parent(),r=t.closest(".lp-course-attribute-values").parent().data("attribute");t.data("value");t.removeClass("active"),u=u.removeQueryVar(r)})),e(this).prop("disabled",!0),d()})),e(document).off("click","#"+a+" .lp-course-attribute-values a").on("click","#"+a+" .lp-course-attribute-values a",(function(t){t.preventDefault();var r=e(this).parent(),a=r.closest(".lp-course-attribute-values").parent().data("attribute"),o=r.data("value");r.toggleClass("active"),u=r.hasClass("active")?function(e,t){var r=u.getQueryVar(e);return r?-1==r.indexOf(t)&&(r+=","+t):r=t,u=u.addQueryVar(e,r)}(a,o):function(e,t){var r=u.getQueryVar(e);return r&&(r=r.replace(t,"").split(",").filter((function(e,t){return e+""!=""})).join(","),u=r?u.addQueryVar(e,r):u.removeQueryVar(e)),u}(a,o),d()}))}))}}(jQuery);