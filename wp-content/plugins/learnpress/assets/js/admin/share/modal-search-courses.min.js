const $=window.jQuery,_=window._;window.$Vue=window.$Vue||window.Vue,$(document).ready((function(){const e=!!$Vue&&$Vue.http;document.getElementById("vue-modal-search-items")&&$Vue&&($Vue.component("learn-press-modal-search-items",{template:"#learn-press-modal-search-items",data:()=>({paged:1,term:"",hasItems:!1,selected:[]}),watch:{show(e){e&&$(this.$refs.search).focus()}},props:["postType","context","contextId","show","callbacks","exclude"],created(){},mounted(){this.term="",this.paged=1,this.search()},methods:{doSearch(e){this.term=e.target.value,this.paged=1,this.search()},search:_.debounce((function(s){$("#modal-search-items").addClass("loading");const t=this;e.post(window.location.href,{type:this.postType,context:this.context,context_id:this.contextId,term:s||this.term,paged:this.paged,exclude:this.exclude,"lp-ajax":"modal_search_items"},{emulateJSON:!0,params:{}}).then((function(e){const s=LP.parseJSON(e.body||e.bodyText);t.hasItems=!!_.size(s.items),$("#modal-search-items").removeClass("loading"),$(t.$el).find(".search-results").html(s.html).find('input[type="checkbox"]').each((function(){const e=parseInt($(this).val());_.indexOf(t.selected,e)>=0&&(this.checked=!0)})),_.debounce((function(){$(t.$el).find(".search-nav").html(s.nav).find("a, span").addClass("button").filter("span").addClass("disabled")}),10)()}))}),500),loadPage(e){e.preventDefault();const s=$(e.target);if(!s.is("span")){if(s.hasClass("next"))this.paged++;else if(s.hasClass("prev"))this.paged--;else{const e=s.html();this.paged=parseInt(e)}this.search()}},selectItem(e){const s=$(e.target).closest("li").find('input[type="checkbox"]'),t=parseInt(s.val()),a=_.indexOf(this.selected,t);s.is(":checked")?-1===a&&this.selected.push(t):a>=0&&this.selected.splice(a,1)},addItems(){this.callbacks&&this.callbacks.addItems&&this.callbacks.addItems.call(this),$(document).triggerHandler("learn-press/add-order-items",this.selected)},close(){this.$emit("close")}}}),window.LP.$modalSearchItems=new $Vue({el:"#vue-modal-search-items",data:{show:!1,term:"",postType:"",callbacks:{},exclude:"",context:""},methods:{open(e){_.each(e.data,(function(e,s){this[s]=e}),this),this.callbacks=e.callbacks,this.focusSearch()},close(){this.show=!1},focusSearch:_.debounce((function(){$('input[name="search"]',this.$el).focus()}),200)}}))}));