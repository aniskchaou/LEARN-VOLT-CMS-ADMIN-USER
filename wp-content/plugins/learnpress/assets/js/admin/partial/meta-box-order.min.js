!function(e){"use strict";window.$Vue=window.$Vue||Vue,e(document).ready((function(){const t=e("#list-users"),o=e(".list-order-items").find("tbody"),r=function(e,t){return _.template(e,{evaluate:/<#([\s\S]+?)#>/g,interpolate:/\{\{\{([\s\S]+?)\}\}\}/g,escape:/\{\{([^\}]+?)\}\}(?!\})/g})(t)},d={template:"#tmpl-order-advanced-list-item",onRemove:function(){0===this.$el.children().length&&this.$el.append('<li class="user-guest">'+s.i18n_guest+"</li>"),console.log(this.$el)},onAdd:function(){this.$el.find(".user-guest").remove()}},s=lpMetaBoxOrderSettings;t.length&&(t.LP("AdvancedList",d),s.users&&_.forEach(s.users,(function(e,o){t.LP("AdvancedList","add",[r(s.userTextFormat,e),o])}))),o.on("click",".remove-order-item",(function(t){t.preventDefault();const r=e(this).closest("tr"),d=r.data("item_id");r.remove(),0===o.children(":not(.no-order-items)").length&&o.find(".no-order-items").show(),$Vue.http.post(window.location.href,{order_id:e("#post_ID").val(),items:[d],"lp-ajax":"remove_items_from_order"},{emulateJSON:!0,params:{}}).then((function(t){const o=LP.parseJSON(t.body||t.bodyText);e(".order-subtotal").html(o.order_data.subtotal_html),e(".order-total").html(o.order_data.total_html)}))})),e(".order-date.date-picker-backendorder").on("change",(function(){const t=this.value.split("-");["aa","mm","jj"].forEach((function(o,r){e('input[name="'+o+'"]').val(t[r])}))})).datepicker({dateFormat:"yy-mm-dd",numberOfMonths:1,showButtonPanel:!0,select:function(){console.log(arguments)}}),e("#learn-press-add-order-item").on("click",(function(){LP.$modalSearchItems.open({data:{postType:"lp_course",context:"order-items",contextId:e("#post_ID").val(),exclude:e(".list-order-items tbody").children(".order-item-row").map((function(){return e(this).data("id")})).get(),show:!0},callbacks:{addItems:function(){$Vue.http.post(window.location.href,{order_id:this.contextId,items:this.selected,"lp-ajax":"add_items_to_order"},{emulateJSON:!0,params:{}}).then((function(t){const r=LP.parseJSON(t.body||t.bodyText),d=o.find(".no-order-items").hide();e(r.item_html).insertBefore(d),e(".order-subtotal").html(r.order_data.subtotal_html),e(".order-total").html(r.order_data.total_html)})),this.close()}}})})),e(document).on("click",".change-user",(function(o){o.preventDefault(),LP.$modalSearchUsers.open({data:{context:"order-items",contextId:e("#post_ID").val(),show:!0,multiple:"yes"===e(this).data("multiple"),exclude:t.children().map((function(){return e(this).data("id")})).get(),textFormat:s.userTextFormat},callbacks:{addUsers:function(o){if(this.multiple){let o=t;t.length||(o=e(LP.template("tmpl-order-data-user")({multiple:!0})),o.LP("AdvancedList",d),e(".order-data-user").replaceWith(o));for(let e=0;e<this.selected.length;e++)o.LP("AdvancedList","add",[r(this.textFormat,this.selected[e]),this.selected[e].id])}else{const t=LP.template("tmpl-order-data-user")({name:r(this.textFormat,this.selected[0]),id:this.selected[0].id});e(".order-data-user").replaceWith(t)}this.close()}}})}))}))}(jQuery);